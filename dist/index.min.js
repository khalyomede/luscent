!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).luscent={})}(this,(function(t){"use strict";function e(t,e,n,r){return new(n||(n=Promise))((function(a,u){function i(t){try{c(r.next(t))}catch(t){u(t)}}function o(t){try{c(r.throw(t))}catch(t){u(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,o)}c((r=r.apply(t,e||[])).next())}))}function n(t,e){var n,r,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(u=0)),u;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(a=u.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){u.label=o[1];break}if(6===o[0]&&u.label<a[1]){u.label=a[1],a=o;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(o);break}a[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(t,u)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}function r(t,e){return void 0===e&&(e=document),Array.from(e.querySelectorAll("[".concat(t,"]"))).filter((function(t){return t instanceof HTMLElement}))}function a(t,a){return e(this,arguments,Promise,(function(t,e,a,u){var i,o,c,s,l,f;return void 0===a&&(a=document),n(this,(function(n){for(i=r("data-luscent-value",a),o=0,c=i;o<c.length;o++)if(s=c[o],(u||!s.closest("[data-luscent-for]"))&&(l=s.getAttribute("data-luscent-value"))){if(f=void 0,u&&l in u)f=u[l];else if(e[l])f=e[l](t.state);else{if(!(l in t.state)){console.warn('No getter or state property found for data-luscent-value="'.concat(l,'"'));continue}f=t.state[l]}s instanceof HTMLInputElement?s.value=String(f):s.textContent=String(f)}return[2]}))}))}function u(t,e,n,a){void 0===n&&(n=document);for(var u=0,i=r("data-luscent-attach",n);u<i.length;u++){var o=i[u],c=o.getAttribute("data-luscent-attach"),s=o.getAttribute("data-luscent-with");if(c&&s){var l=void 0;if(e[s])l=e[s](t.state);else{if(!(s in t.state)){console.warn('No attribute getter or state property found for data-luscent-with="'.concat(s,'"'));continue}l=t.state[s]}null==l?o.removeAttribute(c):!0===l?o.setAttribute(c,""):o.setAttribute(c,String(l))}}}function i(t,r,a,u,i,o){return e(this,arguments,Promise,(function(t,e,r,a,u,i,o){var c,s,f,d,v,h,m,b,p,g,y,T,w;return void 0===o&&(o=document),n(this,(function(n){switch(n.label){case 0:for(f in s=[],c=a)s.push(f);d=0,n.label=1;case 1:if(!(d<s.length))return[3,6];if(!((f=s[d])in c))return[3,5];h=function(t,e,n){return void 0===n&&(n=document),Array.from(n.querySelectorAll("[".concat(t,'="').concat(e,'"]'))).filter((function(t){return t instanceof HTMLElement}))}("data-luscent-if",v=f,o),m=a[v](t.state),b=0,p=h,n.label=2;case 2:return b<p.length?(g=p[b],(y=g.dataset.luscentTemplate)&&(T=document.getElementById(y))instanceof HTMLTemplateElement?(g.innerHTML="",m?(w=T.content.cloneNode(!0),g.appendChild(w),[4,l(t,e,r,a,u,i,g)]):[3,4]):[3,4]):[3,5];case 3:n.sent(),n.label=4;case 4:return b++,[3,2];case 5:return d++,[3,1];case 6:return[2]}}))}))}function o(t,i,o,c,l,f){return e(this,arguments,Promise,(function(t,e,i,o,c,l,f){var d,v,h,m,b,p,g,y,T,w,E,L,A;return void 0===f&&(f=document),n(this,(function(o){switch(o.label){case 0:d=r("data-luscent-for",f),v=0,h=d,o.label=1;case 1:if(!(v<h.length))return[3,6];if(m=h[v],!(b=m.dataset.luscentFor)||!c[b])return[3,5];if(!(p=m.dataset.luscentTemplate))return[3,5];if(!((g=document.getElementById(p))instanceof HTMLTemplateElement))return[3,5];y=m.dataset.luscentKey||"id",T=c[b](t.state),m.innerHTML="",w=function(r){var o,c,f;return n(this,(function(n){switch(n.label){case 0:return o=r[y],c=g.content.cloneNode(!0),Array.from(c.children).forEach((function(t){t instanceof HTMLElement&&void 0!==o&&(t.dataset.luscentId=String(o))})),m.appendChild(c),(f=m.lastElementChild)&&f instanceof HTMLElement?[4,a(t,e,f,r)]:[3,3];case 1:return n.sent(),[4,u(t,l,f)];case 2:n.sent(),s(t,i,f),n.label=3;case 3:return[2]}}))},E=0,L=T,o.label=2;case 2:return E<L.length?(A=L[E],[5,w(A)]):[3,5];case 3:o.sent(),o.label=4;case 4:return E++,[3,2];case 5:return v++,[3,1];case 6:return[2]}}))}))}function c(t,a,u,i){var o=this;void 0===i&&(i=document);for(var c=function(t){if(!(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement))return"continue";var r=t.dataset.luscentBind;return r?"true"===t.dataset.luscentBound?"continue":(t.dataset.luscentBound="true",void t.addEventListener("input",(function(){return e(o,void 0,void 0,(function(){var e;return n(this,(function(n){switch(n.label){case 0:return(e={})[r]=t.value,[4,u(e)];case 1:return n.sent(),[2]}}))}))}))):"continue"},s=0,l=r("data-luscent-bind",i);s<l.length;s++){c(l[s])}}function s(t,r,a){var u=this;void 0===a&&(a=document);for(var i=function(a){if(!(a instanceof HTMLElement))return"continue";if("true"===a.dataset.luscentBound)return"continue";var i=a.dataset.luscentOn,o=a.dataset.luscentTrigger;if(!i||!o||!r[o])return"continue";a.dataset.luscentBound="true",a.addEventListener(i,(function(i){return e(u,void 0,void 0,(function(){var e,u;return n(this,(function(n){switch(n.label){case 0:return"true"===a.dataset.luscentPreventDefault&&i.preventDefault(),e=a.dataset.luscentId||(null===(u=a.closest("[data-luscent-id]"))||void 0===u?void 0:u.getAttribute("data-luscent-id"))||void 0,[4,r[o](t.state,i,e)];case 1:return n.sent(),[2]}}))}))}))},o=0,c=Array.from(a.querySelectorAll("[data-luscent-on][data-luscent-trigger]"));o<c.length;o++){i(c[o])}}function l(t,c,s,l,f,d){return e(this,arguments,Promise,(function(t,e,c,s,l,f,d){return void 0===d&&(d=document),n(this,(function(n){switch(n.label){case 0:return[4,i(t,e,c,s,l,f,d)];case 1:return n.sent(),[4,o(t,e,c,s,l,f,d)];case 2:return n.sent(),[4,a(t,e,d)];case 3:return n.sent(),u(t,f,d),function(t,e){void 0===e&&(e=document);for(var n=0,a=r("data-luscent-bind",e);n<a.length;n++){var u=a[n];if(u instanceof HTMLInputElement||u instanceof HTMLTextAreaElement){var i=u.dataset.luscentBind;if(i&&i in t.state){var o=t.state[i];u.value=String(o||"")}}}}(t,d),[2]}}))}))}t.start=function(t){var r=this,a=t.state||{},u=t.methods||{},i=t.getters||{},o=t.conditions||{},f=t.lists||{},d=t.attributes||{},v={state:a},h=function(t){return e(r,void 0,Promise,(function(){return n(this,(function(e){switch(e.label){case 0:return Object.assign(v.state,t),[4,l(v,i,u,o,f,d)];case 1:return e.sent(),s(v,u,document),c(0,0,h,document),[2]}}))}))};return setTimeout((function(){return e(r,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,l(v,i,u,o,f,d)];case 1:return t.sent(),s(v,u,document),c(0,0,h,document),console.log("Luscent initialized successfully"),[2]}}))}))}),0),{updateState:h}}}));