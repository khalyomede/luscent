!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).luscent={})}(this,(function(t){"use strict";function e(t,e,n,r){return new(n||(n=Promise))((function(a,u){function i(t){try{c(r.next(t))}catch(t){u(t)}}function o(t){try{c(r.throw(t))}catch(t){u(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,o)}c((r=r.apply(t,e||[])).next())}))}function n(t,e){var n,r,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(u=0)),u;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(a=u.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){u.label=o[1];break}if(6===o[0]&&u.label<a[1]){u.label=a[1],a=o;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(o);break}a[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(t,u)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}function r(t,e){return void 0===e&&(e=document),Array.from(e.querySelectorAll("[".concat(t,"]"))).filter((function(t){return t instanceof HTMLElement}))}function a(t,a){return e(this,arguments,Promise,(function(t,e,a,u){var i,o,c,s,l,f;return void 0===a&&(a=document),n(this,(function(n){for(i=r("data-luscent-value",a),o=0,c=i;o<c.length;o++)if(s=c[o],(u||!s.closest("[data-luscent-for]"))&&(l=s.getAttribute("data-luscent-value"))){if(f=void 0,u&&l in u)f=u[l];else if(e[l])f=e[l](t.state);else{if(!(l in t.state)){console.warn('No getter or state property found for data-luscent-value="'.concat(l,'"'));continue}f=t.state[l]}s instanceof HTMLInputElement?s.value=String(f):s.textContent=String(f)}return[2]}))}))}function u(t,r,a,u,i,o){return e(this,arguments,Promise,(function(t,e,r,a,u,i,o){var c,l,f,d,v,h,m,b,p,g,y,T,w;return void 0===o&&(o=document),n(this,(function(n){switch(n.label){case 0:for(f in l=[],c=a)l.push(f);d=0,n.label=1;case 1:if(!(d<l.length))return[3,6];if(!((f=l[d])in c))return[3,5];h=function(t,e,n){return void 0===n&&(n=document),Array.from(n.querySelectorAll("[".concat(t,'="').concat(e,'"]'))).filter((function(t){return t instanceof HTMLElement}))}("data-luscent-if",v=f,o),m=a[v](t.state),b=0,p=h,n.label=2;case 2:return b<p.length?(g=p[b],(y=g.dataset.luscentTemplate)&&(T=document.getElementById(y))instanceof HTMLTemplateElement?(g.innerHTML="",m?(w=T.content.cloneNode(!0),g.appendChild(w),[4,s(t,e,r,a,u,i,g)]):[3,4]):[3,4]):[3,5];case 3:n.sent(),n.label=4;case 4:return b++,[3,2];case 5:return d++,[3,1];case 6:return[2]}}))}))}function i(t,u,i,o,s,l){return e(this,arguments,Promise,(function(t,e,u,i,o,s,l){var f,d,v,h,m,b,p,g,y,T,w,E,L;return void 0===l&&(l=document),n(this,(function(i){switch(i.label){case 0:f=r("data-luscent-for",l),d=0,v=f,i.label=1;case 1:if(!(d<v.length))return[3,6];if(h=v[d],!(m=h.dataset.luscentFor)||!o[m])return[3,5];if(!(b=h.dataset.luscentTemplate))return[3,5];if(!((p=document.getElementById(b))instanceof HTMLTemplateElement))return[3,5];g=h.dataset.luscentKey||"id",y=o[m](t.state),h.innerHTML="",T=function(r){var i,o,s;return n(this,(function(n){switch(n.label){case 0:return i=r[g],o=p.content.cloneNode(!0),Array.from(o.children).forEach((function(t){t instanceof HTMLElement&&void 0!==i&&(t.dataset.luscentId=String(i))})),h.appendChild(o),(s=h.lastElementChild)&&s instanceof HTMLElement?[4,a(t,e,s,r)]:[3,2];case 1:n.sent(),c(t,u,s),n.label=2;case 2:return[2]}}))},w=0,E=y,i.label=2;case 2:return w<E.length?(L=E[w],[5,T(L)]):[3,5];case 3:i.sent(),i.label=4;case 4:return w++,[3,2];case 5:return d++,[3,1];case 6:return[2]}}))}))}function o(t,a,u,i){var o=this;void 0===i&&(i=document);for(var c=function(t){if(!(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement))return"continue";var r=t.dataset.luscentBind;return r?"true"===t.dataset.luscentBound?"continue":(t.dataset.luscentBound="true",void t.addEventListener("input",(function(){return e(o,void 0,void 0,(function(){var e;return n(this,(function(n){switch(n.label){case 0:return(e={})[r]=t.value,[4,u(e)];case 1:return n.sent(),[2]}}))}))}))):"continue"},s=0,l=r("data-luscent-bind",i);s<l.length;s++){c(l[s])}}function c(t,r,a){var u=this;void 0===a&&(a=document);for(var i=function(a){if(!(a instanceof HTMLElement))return"continue";if("true"===a.dataset.luscentBound)return"continue";var i=a.dataset.luscentOn,o=a.dataset.luscentTrigger;if(!i||!o||!r[o])return"continue";a.dataset.luscentBound="true",a.addEventListener(i,(function(i){return e(u,void 0,void 0,(function(){var e,u;return n(this,(function(n){switch(n.label){case 0:return"true"===a.dataset.luscentPreventDefault&&i.preventDefault(),e=a.dataset.luscentId||(null===(u=a.closest("[data-luscent-id]"))||void 0===u?void 0:u.getAttribute("data-luscent-id"))||void 0,[4,r[o](t.state,i,e)];case 1:return n.sent(),[2]}}))}))}))},o=0,c=Array.from(a.querySelectorAll("[data-luscent-on][data-luscent-trigger]"));o<c.length;o++){i(c[o])}}function s(t,o,c,s,l,f){return e(this,arguments,Promise,(function(t,e,o,c,s,l,f){return void 0===f&&(f=document),n(this,(function(n){switch(n.label){case 0:return[4,u(t,e,o,c,s,l,f)];case 1:return n.sent(),[4,i(t,e,o,c,s,l,f)];case 2:return n.sent(),[4,a(t,e,f)];case 3:return n.sent(),function(t,e,n){void 0===n&&(n=document);for(var a=0,u=r("data-luscent-attach",n);a<u.length;a++){var i=u[a],o=i.getAttribute("data-luscent-attach"),c=i.getAttribute("data-luscent-with");if(o&&c){var s=void 0;if(e[c])s=e[c](t.state);else{if(!(c in t.state)){console.warn('No attribute getter or state property found for data-luscent-with="'.concat(c,'"'));continue}s=t.state[c]}null==s?i.removeAttribute(o):!0===s?i.setAttribute(o,""):i.setAttribute(o,String(s))}}}(t,l,f),function(t,e){void 0===e&&(e=document);for(var n=0,a=r("data-luscent-bind",e);n<a.length;n++){var u=a[n];if(u instanceof HTMLInputElement||u instanceof HTMLTextAreaElement){var i=u.dataset.luscentBind;if(i&&i in t.state){var o=t.state[i];u.value=String(o||"")}}}}(t,f),[2]}}))}))}t.start=function(t){var r=this,a=t.state||{},u=t.methods||{},i=t.getters||{},l=t.conditions||{},f=t.lists||{},d=t.attributes||{},v={state:a},h=function(t){return e(r,void 0,Promise,(function(){return n(this,(function(e){switch(e.label){case 0:return Object.assign(v.state,t),[4,s(v,i,u,l,f,d)];case 1:return e.sent(),c(v,u,document),o(0,0,h,document),[2]}}))}))};return setTimeout((function(){return e(r,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,s(v,i,u,l,f,d)];case 1:return t.sent(),c(v,u,document),o(0,0,h,document),console.log("Luscent initialized successfully"),[2]}}))}))}),0),{updateState:h}}}));