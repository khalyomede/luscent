!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).luscent={})}(this,(function(e){"use strict";var t=function(){return t=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.apply(this,arguments)};function n(e,t,n,a){return new(n||(n=Promise))((function(o,c){function s(e){try{i(a.next(e))}catch(e){c(e)}}function l(e){try{i(a.throw(e))}catch(e){c(e)}}function i(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,l)}i((a=a.apply(e,t||[])).next())}))}function a(e,t){var n,a,o,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=l(0),s.throw=l(1),s.return=l(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function l(l){return function(i){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(c=0)),c;)try{if(n=1,a&&(o=2&l[0]?a.return:l[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,l[1])).done)return o;switch(a=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return c.label++,{value:l[1],done:!1};case 5:c.label++,a=l[1],l=[0];continue;case 7:l=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){c=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){c.label=l[1];break}if(6===l[0]&&c.label<o[1]){c.label=o[1],o=l;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(l);break}o[2]&&c.ops.pop(),c.trys.pop();continue}l=t.call(e,c)}catch(e){l=[6,e],a=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}}var o=function(e,t,n,a,o,c){for(var s=null!=c?c:document,l=0,i=Array.from(s.querySelectorAll("[data-luscent-if]"));l<i.length;l++){var r=i[l];if(r instanceof HTMLElement){var u=r.id,f=u.length>0,h=r.dataset.luscentIf;if(void 0!==h)if(h in a)if(a[h](e.state)){var m=r.dataset.luscentTemplate;if(void 0===m){f?console.warn('The element with id "'.concat(u,'" could not be shown/hidden because it has an empty data-luscent-template')):console.warn("An element could not be shown/hidden because it has an empty data-luscent-template");continue}var p=document.getElementById(m);if(null===p||!(p instanceof HTMLTemplateElement)){f?console.warn('The element with id "'.concat(u,'" could not be shown/hidden because no template exist with id empty data-luscent-template="').concat(m,'"')):console.warn('An element could not be shown/hidden because no template exist with id empty data-luscent-template="'.concat(m,'"'));continue}for(var w=p.content.cloneNode(!0),v="luscent-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)),b=0,y=Array.from(w.childNodes).filter((function(e){return e instanceof HTMLElement}));b<y.length;b++){y[b].dataset.luscentId=v}r.textContent="",r.appendChild(w);for(var g=0,T=Array.from(document.querySelectorAll('[data-luscent-id="'.concat(v,'"]')));g<T.length;g++){var A=T[g];d(e,t,n,a,o,A)}}else r.textContent="";else f?console.warn('The element with id "'.concat(u,'" could not be shown/hidden because it uses data-luscent-if="').concat(h,'" but no conditions was found with this key')):console.warn('An element could not be shown/hidden because it uses data-luscent-if="'.concat(h,'" but no conditions was found with this key'));else f?console.warn('The element with id "'.concat(u,'" cannot be shown/hidden because data-luscent-if target an empty key.')):console.warn("An element cannot be shown/hidden because data-luscent-if target an empty key.")}}},c=function(e,t){for(var n=0,a=Array.from(e.querySelectorAll("[data-luscent-id]"));n<a.length;n++){var o=a[n];if(!(o instanceof HTMLElement))return;var c=o.dataset.luscentId;if(c&&c in t){var s=t[c];o.dataset.luscentRenderedId=String(s)}}},s=function(e,t,n,a,o,s){for(var l=null!=s?s:document,i=0,r=Array.from(l.querySelectorAll("[data-luscent-for]"));i<r.length;i++){var u=r[i];if(u instanceof HTMLElement){var f=u.id,h=f.length>0,m=u.dataset.luscentFor;if(void 0!==m)if(m in o){var p=u.dataset.luscentTemplate;if(void 0!==p){var w=document.getElementById(p);if(null!==w&&w instanceof HTMLTemplateElement){u.textContent="";for(var v=0,b=o[m](e.state);v<b.length;v++){for(var y=b[v],g=w.content.cloneNode(!0),T="luscent-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)),A=0,E=Array.from(g.childNodes).filter((function(e){return e instanceof HTMLElement}));A<E.length;A++){E[A].dataset.luscentKey=T}u.appendChild(g);for(var I=0,L=Array.from(document.querySelectorAll('[data-luscent-key="'.concat(T,'"]')));I<L.length;I++){var O=L[I];c(O,y),d(e,t,n,a,o,O,y)}}}else h?console.warn('The element with id "'.concat(f,'" could not iterate because no template exists with id data-luscent-template="').concat(p,'".')):console.warn('An element could not iterate because no template exists with id data-luscent-template="'.concat(p,'".'))}else h?console.warn('The element with id "'.concat(f,'" could not iterate because it has an empty data-luscent-template.')):console.warn("An element could not iterate because it has an empty data-luscent-template.")}else h?console.warn('The element with id "'.concat(f,'" could not iterate because it uses data-luscent-for="').concat(m,'" but no list was found with this key.')):console.warn('An element could not iterate because it uses data-luscent-for="'.concat(m,'" but no list was found with this key.'));else h?console.warn('The element with id "'.concat(f,'" cannot iterate because data-luscent-for targets an empty key.')):console.warn("An element cannot iterate because data-luscent-for targets an empty key.")}}},l=function(e,t,n,a){(null!=n?n:document).querySelectorAll("[data-luscent-value]").forEach((function(n){if(a||!n.closest("[data-luscent-for]")){var o=n.getAttribute("data-luscent-value"),c=null===o||0===o.trim().length,s=n.id.trim().length>0,l=n.id;if(c)s?console.warn('The element id "'.concat(l,'" seems to have a data-luscent-value with an empty value. Please fill it to let the UI update pursue correctly.')):console.warn("It seems you have a data-luscent-value with an empty value. Please fill it to let the UI update pursue correctly.");else if(a||t.hasOwnProperty(o)){var i=a?a[o]:t[o](e.state);n instanceof HTMLInputElement?n.value=i:n.textContent=i}else s?console.warn('The element id "'.concat(l,'" content with data-luscent-value="').concat(o,'" could not be rendered because a getter with the same name could not be found.')):console.warn('The UI rendering failed for an element content with data-luscent-value="'.concat(o,'" could not be rendered because a getter with the same name Could not be found.'))}}))},i=function(e,t,o){for(var c,s=null!=o?o:document,l=document.evaluate('//*[./@*[starts-with(name(), "data-luscent-on-")]]',s,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),i=function(o){var s=l.snapshotItem(o);if(s instanceof HTMLElement){var i=Object.keys(s.dataset);if(i.some((function(e){return e.endsWith("Bind")})))return"continue";var r=null!==(c=i.filter((function(e){return e.startsWith("luscentOn")}))[0])&&void 0!==c?c:"",u=r.replace("luscentOn","").toLowerCase(),d=s.dataset[r],f="luscentOn".concat(u.charAt(0).toUpperCase()+u.slice(1),"Bound");if("true"===s.dataset[f])return"continue";d&&t[d]&&(s.addEventListener(u,(function(o){return n(void 0,void 0,void 0,(function(){var n;return a(this,(function(a){switch(a.label){case 0:return"submit"===u&&o.preventDefault(),n=s.dataset.luscentRenderedId,[4,t[d](e.state,o,n)];case 1:return a.sent(),[2]}}))}))}),{passive:"submit"!==u,capture:!0}),s.dataset[f]="true")}},r=0;r<l.snapshotLength;r++)i(r)},r=function(e,t){for(var n=null!=t?t:document,a=0,o=Array.from(n.querySelectorAll("[data-luscent-on-input-bind]"));a<o.length;a++){var c=o[a];if(c instanceof HTMLElement){var s=c.id,l=s.trim().length>0,i=c.dataset.luscentOnInputBind;if(void 0!==i)if(i in e.state)if(c instanceof HTMLInputElement){var r=e.state[i];c.value=String(r)}else l?console.warn('The element with id "'.concat(s,'" has data-luscent-on-input-bind="').concat(i,'" but is not an input element. Cannot sync with state.')):console.warn('An element has data-luscent-on-input-bind="'.concat(i,'" but is not an input element. Cannot sync with state.'));else l?console.warn('The element with id "'.concat(s,'" has data-luscent-on-input-bind="').concat(i,'", but no corresponding state property exists.')):console.warn('An element has data-luscent-on-input-bind="'.concat(i,'", but no corresponding state property exists.'));else l?console.warn('The element with id "'.concat(s,'" has an empty data-luscent-on-input-bind attribute. Cannot sync with state.')):console.warn("An element has an empty data-luscent-on-input-bind attribute. Cannot sync with state.")}}},u=function(e,n,a,o,c){for(var s=document.evaluate('//*[./@*[starts-with(name(), "data-luscent-on-") and substring(name(), string-length(name()) - 4) = "-bind"]]',document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),l=0;l<s.snapshotLength;l++){var i=s.snapshotItem(l);if(i instanceof HTMLElement)for(var r=i.id,u=r.trim().length>0,f=function(s){var l=s.replace("luscentOn","").replace("Bind","").toLowerCase(),f=i.dataset[s],h="luscentOn".concat(l.charAt(0).toUpperCase()+l.slice(1),"BindBound");return"true"===i.dataset[h]?"continue":f?i instanceof HTMLInputElement?(i.addEventListener(l,(function(s){var l;if(s instanceof InputEvent){var i=s.target;e.state=t(t({},e.state),((l={})[f]=i.value,l)),d(e,n,a,o,c)}})),void(i.dataset[h]="true")):(u?console.warn("It seems you tried to bind a value (using data-luscent-on-".concat(l,'-bind="').concat(f,'") on the element with id "').concat(r,"\" that is not an HTMLInputElement. This won't make the data reactive.")):console.warn("It seems you tried to bind a value (using data-luscent-on-".concat(l,'-bind="').concat(f,"\") on an element that is not an HTMLInputElement. This won't make the data reactive.")),"continue"):(u?console.warn("Please specify a key when using data-luscent-on-".concat(l,'-bind on the element with id "').concat(r,'".')):console.warn("Please specify a key when using data-luscent-on-".concat(l,"-bind.")),"continue")},h=0,m=Object.keys(i.dataset).filter((function(e){return e.startsWith("luscentOn")&&e.endsWith("Bind")}));h<m.length;h++){f(m[h])}}},d=function(e,t,n,a,c,d,f){l(e,t,d,f),r(e,d),o(e,t,n,a,c,d),c&&s(e,t,n,a,c,d),i(e,n,d),u(e,t,n,a,c)},f=function(e){var n=e.state||{},a=e.methods||{},o=e.getters||{},c=e.conditions||{},s=e.lists||{},l={state:n};return d(l,o,a,c,s),console.log("Luscent app started successfully"),{updateState:function(e){l.state=t(t({},l.state),e),d(l,o,a,c,s)}}};e.start=f}));