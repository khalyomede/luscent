!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).luscent={})}(this,(function(e){"use strict";var t=function(){return t=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.apply(this,arguments)};function n(e,t,n,a){return new(n||(n=Promise))((function(o,c){function l(e){try{r(a.next(e))}catch(e){c(e)}}function s(e){try{r(a.throw(e))}catch(e){c(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,s)}r((a=a.apply(e,t||[])).next())}))}function a(e,t){var n,a,o,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=s(0),l.throw=s(1),l.return=s(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function s(s){return function(r){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(c=0)),c;)try{if(n=1,a&&(o=2&s[0]?a.return:s[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,s[1])).done)return o;switch(a=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,a=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){c.label=s[1];break}if(6===s[0]&&c.label<o[1]){c.label=o[1],o=s;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(s);break}o[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],a=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,r])}}}var o=function(e,t,n,a,o,c){for(var l=null!=c?c:document,s=0,r=Array.from(l.querySelectorAll("[data-luscent-if]"));s<r.length;s++){var i=r[s];if(i instanceof HTMLElement){var u=i.id,d=u.length>0,f=i.dataset.luscentIf;if(void 0!==f)if(f in a)if(a[f](e.state)){var h=i.dataset.luscentTemplate;if(void 0===h){d?console.warn('The element with id "'.concat(u,'" could not be shown/hidden because it has an empty data-luscent-template')):console.warn("An element could not be shown/hidden because it has an empty data-luscent-template");continue}var m=document.getElementById(h);if(null===m||!(m instanceof HTMLTemplateElement)){d?console.warn('The element with id "'.concat(u,'" could not be shown/hidden because no template exist with id empty data-luscent-template="').concat(h,'"')):console.warn('An element could not be shown/hidden because no template exist with id empty data-luscent-template="'.concat(h,'"'));continue}for(var v=m.content.cloneNode(!0),w="luscent-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)),y=0,b=Array.from(v.childNodes).filter((function(e){return e instanceof HTMLElement}));y<b.length;y++){b[y].dataset.luscentId=w}i.textContent="",i.appendChild(v);for(var g=0,T=Array.from(document.querySelectorAll('[data-luscent-id="'.concat(w,'"]')));g<T.length;g++){var A=T[g];p(e,t,n,a,o,A)}}else i.textContent="";else d?console.warn('The element with id "'.concat(u,'" could not be shown/hidden because it uses data-luscent-if="').concat(f,'" but no conditions was found with this key')):console.warn('An element could not be shown/hidden because it uses data-luscent-if="'.concat(f,'" but no conditions was found with this key'));else d?console.warn('The element with id "'.concat(u,'" cannot be shown/hidden because data-luscent-if target an empty key.')):console.warn("An element cannot be shown/hidden because data-luscent-if target an empty key.")}}},c=function(e,t){for(var n=0,a=Array.from(e.querySelectorAll("[data-luscent-id]"));n<a.length;n++){var o=a[n];if(!(o instanceof HTMLElement))return;var c=o.dataset.luscentId;if(c&&c in t){var l=t[c];o.dataset.luscentRenderedId=String(l)}}},l=function(e,t,n,a,o,l){for(var s=null!=l?l:document,r=0,i=Array.from(s.querySelectorAll("[data-luscent-for]"));r<i.length;r++){var u=i[r];if(u instanceof HTMLElement){var d=u.id,f=d.length>0,h=u.dataset.luscentFor;if(void 0!==h)if(h in o){var m=u.dataset.luscentTemplate;if(void 0!==m){var v=document.getElementById(m);if(null!==v&&v instanceof HTMLTemplateElement){var w=o[h](e.state),y=u.dataset.luscentKey;if(void 0!==y)for(var b=0,g=w;b<g.length;b++){var T=g[b],A=T[y];if(null===u.querySelector('[data-luscent-key="'.concat(A,'"]'))){for(var E=v.content.cloneNode(!0),k=0,I=Array.from(E.childNodes).filter((function(e){return e instanceof HTMLElement}));k<I.length;k++){I[k].dataset.luscentKey=A}u.appendChild(E);for(var L=0,O=Array.from(document.querySelectorAll('[data-luscent-key="'.concat(A,'"]')));L<O.length;L++){var S=O[L];c(S,T),p(e,t,n,a,o,S,T)}}else console.debug("skipping rendering for element with id ".concat(A))}}else f?console.warn('The element with id "'.concat(d,'" could not iterate because no template exists with id data-luscent-template="').concat(m,'".')):console.warn('An element could not iterate because no template exists with id data-luscent-template="'.concat(m,'".'))}else f?console.warn('The element with id "'.concat(d,'" could not iterate because it has an empty data-luscent-template.')):console.warn("An element could not iterate because it has an empty data-luscent-template.")}else f?console.warn('The element with id "'.concat(d,'" could not iterate because it uses data-luscent-for="').concat(h,'" but no list was found with this key.')):console.warn('An element could not iterate because it uses data-luscent-for="'.concat(h,'" but no list was found with this key.'));else f?console.warn('The element with id "'.concat(d,'" cannot iterate because data-luscent-for targets an empty key.')):console.warn("An element cannot iterate because data-luscent-for targets an empty key.")}}},s=function(e,t,n,a){(null!=n?n:document).querySelectorAll("[data-luscent-value]").forEach((function(n){if(a||!n.closest("[data-luscent-for]")){var o=n.getAttribute("data-luscent-value"),c=null===o||0===o.trim().length,l=n.id.trim().length>0,s=n.id;if(c)l?console.warn('The element id "'.concat(s,'" seems to have a data-luscent-value with an empty value. Please fill it to let the UI update pursue correctly.')):console.warn("It seems you have a data-luscent-value with an empty value. Please fill it to let the UI update pursue correctly.");else if(a||t.hasOwnProperty(o)){var r=a?a[o]:t[o](e.state);n instanceof HTMLInputElement?n.value=r:n.textContent=r}else l?console.warn('The element id "'.concat(s,'" content with data-luscent-value="').concat(o,'" could not be rendered because a getter with the same name could not be found.')):console.warn('The UI rendering failed for an element content with data-luscent-value="'.concat(o,'" could not be rendered because a getter with the same name Could not be found.'))}}))},r=function(e,t){void 0===t&&(t=null);for(var n=[],a=document.evaluate(e,null!=t?t:document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),o=0;o<a.snapshotLength;o++){var c=a.snapshotItem(o);null!==c&&c instanceof HTMLElement&&n.push(c)}return n},i=function(e,t,o){for(var c,l=null!=o?o:document,s=function(o){var l=Object.keys(o.dataset);if(l.some((function(e){return e.endsWith("Bind")})))return"continue";var s=null!==(c=l.filter((function(e){return e.startsWith("luscentOn")}))[0])&&void 0!==c?c:"",r=s.replace("luscentOn","").toLowerCase(),i=o.dataset[s],u="luscentOn".concat(r.charAt(0).toUpperCase()+r.slice(1),"Bound");if("true"===o.dataset[u])return"continue";i&&t[i]&&(o.addEventListener(r,(function(c){return n(void 0,void 0,void 0,(function(){var n;return a(this,(function(a){switch(a.label){case 0:return"submit"===r&&c.preventDefault(),n=o.dataset.luscentRenderedId,[4,t[i](e.state,c,n)];case 1:return a.sent(),[2]}}))}))}),{passive:"submit"!==r,capture:!0}),o.dataset[u]="true")},i=0,u=r('//*[./@*[starts-with(name(), "data-luscent-on-")]]',l);i<u.length;i++){s(u[i])}},u=function(e,t){for(var n=null!=t?t:document,a=0,o=Array.from(n.querySelectorAll("[data-luscent-on-input-bind]"));a<o.length;a++){var c=o[a];if(c instanceof HTMLElement){var l=c.id,s=l.trim().length>0,r=c.dataset.luscentOnInputBind;if(void 0!==r)if(r in e.state)if(c instanceof HTMLInputElement){var i=e.state[r];c.value=String(i)}else s?console.warn('The element with id "'.concat(l,'" has data-luscent-on-input-bind="').concat(r,'" but is not an input element. Cannot sync with state.')):console.warn('An element has data-luscent-on-input-bind="'.concat(r,'" but is not an input element. Cannot sync with state.'));else s?console.warn('The element with id "'.concat(l,'" has data-luscent-on-input-bind="').concat(r,'", but no corresponding state property exists.')):console.warn('An element has data-luscent-on-input-bind="'.concat(r,'", but no corresponding state property exists.'));else s?console.warn('The element with id "'.concat(l,'" has an empty data-luscent-on-input-bind attribute. Cannot sync with state.')):console.warn("An element has an empty data-luscent-on-input-bind attribute. Cannot sync with state.")}}},d=function(e,n,a,o,c){for(var l=0,s=r('//*[./@*[starts-with(name(), "data-luscent-on-") and substring(name(), string-length(name()) - 4) = "-bind"]]');l<s.length;l++)for(var i=s[l],u=i.id,d=u.trim().length>0,f=function(l){var s=l.replace("luscentOn","").replace("Bind","").toLowerCase(),r=i.dataset[l],f="luscentOn".concat(s.charAt(0).toUpperCase()+s.slice(1),"BindBound");return"true"===i.dataset[f]?"continue":r?i instanceof HTMLInputElement?(i.addEventListener(s,(function(l){var s;if(l instanceof InputEvent){var i=l.target;e.state=t(t({},e.state),((s={})[r]=i.value,s)),p(e,n,a,o,c)}})),void(i.dataset[f]="true")):(d?console.warn("It seems you tried to bind a value (using data-luscent-on-".concat(s,'-bind="').concat(r,'") on the element with id "').concat(u,"\" that is not an HTMLInputElement. This won't make the data reactive.")):console.warn("It seems you tried to bind a value (using data-luscent-on-".concat(s,'-bind="').concat(r,"\") on an element that is not an HTMLInputElement. This won't make the data reactive.")),"continue"):(d?console.warn("Please specify a key when using data-luscent-on-".concat(s,'-bind on the element with id "').concat(u,'".')):console.warn("Please specify a key when using data-luscent-on-".concat(s,"-bind.")),"continue")},h=0,m=Object.keys(i.dataset).filter((function(e){return e.startsWith("luscentOn")&&e.endsWith("Bind")}));h<m.length;h++){f(m[h])}},f=function(e){return e.replace(/([A-Z])/g,"-$1").replace(/[\s_-]+/g,"-").toLowerCase().replace(/^-/,"").replace(/-$/,"")},h=function(e){var t;for(var n in e)if(n.startsWith("luscentSet"))return{key:n.replace("luscentSet",""),value:null!==(t=e[n])&&void 0!==t?t:null};return null},m=function(e,t,n,a){for(var o=null!=n?n:document,c=0,l=r('//*[./@*[starts-with(name(), "data-luscent-set-")]]',o);c<l.length;c++){var s=l[c],i=h(s.dataset);if(null!==i){var u=i.key,d=i.value;if(null!==d&&0!==d.trim().length&&0!==u.trim().length){var m=void 0!==a?a[d]:t[d](e.state);s.setAttribute(f(u),m)}}}},p=function(e,t,n,a,c,r,f){s(e,t,r,f),m(e,t,r,f),u(e,r),o(e,t,n,a,c,r),c&&l(e,t,n,a,c,r),i(e,n,r),d(e,t,n,a,c)},v=function(e){var n=e.state||{},a=e.methods||{},o=e.getters||{},c=e.conditions||{},l=e.lists||{},s={state:n};return p(s,o,a,c,l),console.log("Luscent app started successfully"),{updateState:function(e){s.state=t(t({},s.state),e),p(s,o,a,c,l)}}};e.start=v}));